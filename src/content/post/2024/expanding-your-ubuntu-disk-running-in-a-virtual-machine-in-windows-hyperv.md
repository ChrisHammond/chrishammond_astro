---
title: "Expanding your Ubuntu disk running in a Virtual Machine in Windows Hyper-V"
author: Chris Hammond
publishDate: 2024-04-18T17:07:01
updateDate: 2024-04-18T17:30:53
tags: [ 'Jekyll', 'Tutorials', 'Ubuntu', 'Virtual Machines' ]
excerpt: "If you allowed Hyper-V to automatically create your Ubuntu machine you likely will run into disk space issues when you start to use the VM. This blog post will walk you through the steps of expanding the disk to address your disk space issues.  &nbsp; "
url: /2024/expanding-your-ubuntu-disk-running-in-a-virtual-machine-in-windows-hyperv  # Use the generated URL with year
---
<p>Expanding the size of a virtual hard disk for an Ubuntu instance running on Windows Hyper-V involves several steps. Here&#39;s a detailed guide to help you increase the disk space:</p>  <h2>1. Shut Down the Ubuntu VM</h2>  <p>Before modifying the disk, it&#39;s safest to shut down the virtual machine (VM). You can do this from within Ubuntu or using the Hyper-V Manager.</p>  <h2>2. Expand the Virtual Hard Disk</h2>  <ol>  <li><strong>Open Hyper-V Manager</strong>: On your Windows host, open Hyper-V Manager.</li>  <li><strong>Select Your VM</strong>: Click on your Ubuntu VM in the list of virtual machines.</li>  <li><strong>Edit Virtual Hard Disk</strong>: With the VM selected, in the right-hand actions panel, click on <strong>Settings</strong>. Under the <strong>Hardware</strong> list, find and select the Hard Drive that you want to expand.  <ol>   <li>If you are unable to click Edit, you likely have Checkpoints enabled in Hyper-V. To edit the hard drive you will need to merge or delete any existing checkpoints.</li>   <li><strong>To Delete Checkpoints:</strong>   <ol>    <li>Open Hyper-V Manager: Start Hyper-V Manager on your Windows host.</li>    <li>Select the Virtual Machine: Click on the virtual machine you want to modify.</li>    <li>Inspect Checkpoints: In the lower right section of the Hyper-V Manager, you will see the Checkpoints section. Select the checkpoint you want to manage.</li>    <li>Delete Checkpoint: Right-click on the checkpoint and choose Delete Checkpoint or Delete Checkpoint Subtree if you want to delete a checkpoint and all its descendants. This action merges the checkpoint data into the base virtual disk or into the next checkpoint in the hierarchy.</li>    <li>Caution: Make sure that deleting the checkpoint won't cause you to lose important data.</li>   </ol>   </li>  </ol>  </li>  <li><strong>Modify Disk</strong>: Click on the <strong>Edit</strong> button on the right side of the Virtual hard disk path. This opens the Edit Virtual Hard Disk Wizard.</li>  <li><strong>Choose Action</strong>: Select <strong>Expand</strong> and then click <strong>Next</strong>.</li>  <li><strong>Specify New Size</strong>: Enter the new size for your virtual disk. Make sure it&#39;s larger than the current size.</li>  <li><strong>Complete the Wizard</strong>: Follow through the wizard and apply the changes.</li> </ol>  <h2>3. Start the Ubuntu VM</h2>  <p>After the disk has been expanded, start your Ubuntu VM to make the operating system recognize the change.</p>  <h2>4. Resize the Partition Within Ubuntu</h2>  <p>To make use of the newly added space, you need to resize the partition and filesystem within Ubuntu.</p>  <ol>  <li><strong>Identify the Disk</strong>: First, you need to identify the disk name and partition. Open a terminal and use the command: <code>lsblk</code>. This will list all the disks and partitions. Identify the partition you want to expand (commonly something like <code>/dev/sda1</code>).</li>  <li><strong>Check and Repair the Filesystem</strong> (if needed): It&#39;s good practice to check the filesystem integrity before resizing. You can do this with the command:  <pre> <code>sudo e2fsck -f /dev/sda1</code></pre>  Replace <code>/dev/sda1</code> with your partition identifier.</li>  <li><strong>Resize the Partition</strong>: If your root partition is directly resizable, you can use growpart:  <pre> <code>sudo apt update &amp;&amp; sudo apt install cloud-guest-utils sudo growpart /dev/sda1</code></pre>  <br />  This resizes the first partition on <code>/dev/sda</code>.</li>  <li><strong>Resize the Filesystem</strong>: Finally, resize the filesystem:  <pre> <code>sudo resize2fs /dev/sda1</code></pre>  . This command expands the filesystem on the partition to use all available space.</li> </ol>  <h2>5. Verify the Changes</h2>  <p>Check that the filesystem now uses the new space:</p>  <p>&nbsp;</p>  <pre> <code>df -h</code></pre>  <p>&nbsp;</p>  <p>This will show the disk space usage, and you should see that the available space has increased according to the changes you made.</p>  <p>Following these steps will allow you to successfully increase the disk size of your Ubuntu VM running on Windows Hyper-V.</p> 
