---
title: "Microsoft Enterprise Library Data Access Application Blocks Execute Reader (Object must implement IConvertible)"
author: Chris Hammond
publishDate: 2005-03-08T10:27:00
updateDate: 2008-01-23T16:50:52
tags: [ 'Development', 'Life News', 'SEO', 'Technology' ]
excerpt: "Learn how to successfully use the MS Enterprise Library Data Access Application Blocks for executing readers with this helpful code snippet and resources."
url: /2005/microsoft-enterprise-library-data-access-application-blocks-execute-reader-object-must-implement-iconvertible  # Use the generated URL with year
---
<P>I've been trying to get the MS Enterprise Library Data Access Applications Blocks working this morning. Yesterday I got the library setup and running. I started to implement the DAAB so that I could call a stored procedure, passing in a parameter, and retrieving a datareader that I could fill into a class. But I was having some horrible problems trying to get the stored procedure to run and fill the datareader using the DAAB.</P> <P>I was continually getting the error &#8220;Object must implement IConvertible&#8220; and was unable to figure out why this was.</P><FONT size=2> <P>sqlCommand = "spCMS_CustomerLostPasswordEmailAddress";<BR></FONT><FONT color=#008000 size=2>//parameters<BR></FONT><FONT size=2>SqlParameter [] parms = {</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> SqlParameter("@EmailAddress", SqlDbType.VarChar, 50)};<BR>parms[0].Value= identifier;<BR>DBCommandWrapper dbcw = db.GetStoredProcCommandWrapper(sqlCommand,parms);<BR></FONT><FONT size=2>SqlDataReader dr = db.ExecuteReader(dbcw);</FONT></P> <P>It would return the error while trying to perform the ExecuteReader command.</P> <P>In order to get the code to successfully function I had to do the following</P><FONT size=2> <P>DBCommandWrapper dbcw = db.GetStoredProcCommandWrapper("spCMS_CustomerLostPasswordEmailAddress");<BR>dbcw.AddInParameter("@EmailAddress", DbType.String, identifier);<BR></FONT><FONT size=2>SqlDataReader dr = (SqlDataReader)db.ExecuteReader(dbcw);</FONT></P> <P>So if you're looking to use execute reader with the Microsoft Enterprise Library Data Access Application Blocks I hope the above code helps!</P> <P>Also, some resources I used to figure all of this out!</P> <P><A href="https://www.donkitchen.com/2005/01/enterprise_libr.html">Enterprise Library / Data Access Application Block Follow-up</A><BR><A href="https://aspnet.4guysfromrolla.com/articles/022305-1.aspx">An Introduction to the Microsoft Enterprise Library</A>&nbsp;by <A href="https://www.scottonwriting.net/sowBlog/">Scott Mitchell</A></P> <P>&nbsp;</P>


