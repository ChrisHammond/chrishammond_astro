---
title: "A fix for DotNetNuke ScriptManager Errors, Ajax issues"
author: Chris Hammond
publishDate: 2008-02-28T00:17:25
updateDate: 2008-04-17T17:33:55
tags: [ 'aspnet', 'DotNetNuke', 'DotNetNuke Tips', 'VBNet' ]
excerpt: "Yesterday I posted that I had found a fix for the issues with the Ajax ScriptManager issues that have been occuring with DNN 4.7 and greater.  Well here it is! It's not pretty, but from my testing so far it appears to fix the problems I've been having here on www.ChrisHammond.com  To use this fix you're going to have to recompile the DotNetNuke Source package you can download from www.dotnetnuke.com. I've only tested this with 4.8.1 source, but I don't believe there should be any issues if you're trying to recompile 4.7.0 or 4.8.0. Here are the two files you need to make changes to.  This fix does not apply to DNN 4.8.2 or greater, 4.8.2 has a fix for the issue"
url: /2008/a-fix-for-dotnetnuke-scriptmanager-errors-ajax-issues  # Use the generated URL with year
---
<p>&#160;</p> <p><u><font color="#810081"><strong>This fix does not apply to DNN 4.8.2 or greater, 4.8.2 has a fix for the issue</strong></font></u></p> <p><a href="https://www.chrishammond.com/desktopmodules/engagepublish/itemlink.aspx?itemid=1092">yesterday I posted that I had found a fix for the issues with the Ajax ScriptManager issues that have been occuring with DNN 4.7 and greater.</a></p> <p>Well here it is! It's not pretty, but from my testing so far it appears to fix the problems I've been having here on <a href="https://www.ChrisHammond.com">www.ChrisHammond.com</a></p> <p><strong>THIS IS ONLY A TEMPORARY FIX. Please use this at your own risk, I provide it here just as am immediate fix that worked for me, test in your environment before making production changes!</strong></p> <p>To use this fix you're going to have to recompile the DotNetNuke Source package you can download from <a href="https://www.dotnetnuke.com">www.dotnetnuke.com</a>. I've only tested this with 4.8.1 source, but&#160;I don't believe there should be any issues if you're trying to recompile 4.7.0 or 4.8.0. Here are the two files you need to make changes to.</p> <p>source/library/components/framework/Ajax.vb</p> <p>Line #148<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160; Public Shared Sub RegisterScriptManager()<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not IsEnabled() Then<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AddScriptManager(m_Page)<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160; End Sub</p> <p>'ADDED THE FOLLOWING FOR THE FIX<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160; Public Shared Sub RegisterScriptManager(ByVal objPage As Page)<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not IsEnabled() Then<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AddScriptManager(objPage)<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If<br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160; End Sub</p> <p><br /> source/website/default.aspx.vb</p> <p>Line #209<br /> 'register page with AJAX<br /> 'AJAX.RegisterPage(Me)<br /> AJAX.RegisterScriptManager(Me)</p> <p>Once you make these changes and recompile, you should get a new DotNetNuke.Dll file, I grabbed the one out of my source/library/bin folder, and deployed that to the BIN folder on my production website. I also copied the default.aspx.vb file to the root of my production website.</p> <p>When you compile you can compile in debug or release mode, I chose to compile in release mode.</p> <p>If you have any questions feel free to post them here.</p> <p><strong>This fix does not apply to DNN 4.8.2 or greater, 4.8.2 has a fix for the issue</strong></p>
