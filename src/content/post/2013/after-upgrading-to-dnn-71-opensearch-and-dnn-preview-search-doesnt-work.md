---
title: "After upgrading to DNN 7.1 OpenSearch and DNN Preview Search doesn't work"
author: Chris Hammond
publishDate: 2013-10-13T23:09:58
updateDate: 2013-10-13T23:10:46
tags: [ 'DNN', 'DotNetNuke', 'OpenSearch', 'Search Results' ]
<<<<<<< HEAD
excerpt: "Resolve issues with DNN Search Results post Open Search deactivation. Get your DNN 7.1.2 search functionality working smoothly again with our easy fix."
url: /2013/after-upgrading-to-dnn-71-opensearch-and-dnn-preview-search-doesnt-work  # Use the generated URL with year
---
in a previous blog post I talked about what you can do to get DNN 7.1 working if you previously had Xepient's Open Search installed. One thing I failed to cover though, was what happens after you disable open search? You likely no longer have the DNN Search Results module on a page, and after upgrading to DNN 7.1.2 (I didn't notice this in 7.1.0) you may find that the "Preview" search results in the Search SkinObject no longer work. You may not actually notice, but if you try to "search" and you just get redirected back to the page you were on when you searched, you likely are running into the problem I have a fix for below. Basically the problem is that you don't have a Search Results module on your Search Results page anymore in DNN (I know I removed it back when I started using OpenSearch on this particular site). So what you will need to do is go to your Search Results page (found from admin/page management) and add the Search Results module onto the page. From there, search should hopefully start working again for you. Here is the error message I was getting in the Log Viewer (event viewer, eventlog table), a tad cryptic, but I am glad I was able to track down the issue for my customer's site.   System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection. Parameter name: index at System.Collections.ArrayList.get_Item(Int32 index) at DotNetNuke.Web.InternalServices.SearchServiceController.GetSearchModule() at DotNetNuke.Web.InternalServices.SearchServiceController.GetSearchModuleSettings() at DotNetNuke.Web.InternalServices.SearchServiceController.Preview(String keywords, String culture, Int32 forceWild, Int32 portal) at lambda_method(Closure , Object , Object[] ) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.&lt;&gt;c__DisplayClass13.&lt;GetExecutor&gt;b__c(Object instance, Object[] methodParameters) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.&lt;&gt;c__DisplayClass5.&lt;ExecuteAsync&gt;b__4() at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken) &nbsp; &nbsp;




=======
excerpt: "Learn how to fix Search SkinObject preview issues in DNN 7.1.2 after disabling Open Search. Add the Search Results module to restore search functionality."
url: /2013/after-upgrading-to-dnn-71-opensearch-and-dnn-preview-search-doesnt-work  # Use the generated URL with year
---
<p><a href="https://www.chrishammond.com/blog/itemid/2633/dnn-71-fails-to-load-with-opensearch-from-xepient">in a previous blog post I talked about what you can do to get DNN 7.1 working if you previously had Xepient's Open Search installed</a>. One thing I failed to cover though, was what happens after you disable open search? You likely no longer have the DNN Search Results module on a page, and after upgrading to DNN 7.1.2 (I didn't notice this in 7.1.0) you may find that the "Preview" search results in the Search SkinObject no longer work.</p> <p>You may not actually notice, but if you try to "search" and you just get redirected back to the page you were on when you searched, you likely are running into the problem I have a fix for below.</p> <p>Basically the problem is that you don't have a Search Results module on your Search Results page anymore in DNN (I know I removed it back when I started using OpenSearch on this particular site).</p> <p>So what you will need to do is go to your Search Results page (found from admin/page management) and add the Search Results module onto the page.</p> <p>From there, search should hopefully start working again for you.</p> <p>Here is the error message I was getting in the Log Viewer (event viewer, eventlog table), a tad cryptic, but I am glad I was able to track down the issue for my customer's site.</p> <p style="margin-left: 40px;"> </p> <pre style="color: #444444; margin-bottom: 0px;">System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection. Parameter name: index at System.Collections.ArrayList.get_Item(Int32 index) at DotNetNuke.Web.InternalServices.SearchServiceController.GetSearchModule() at DotNetNuke.Web.InternalServices.SearchServiceController.GetSearchModuleSettings() at DotNetNuke.Web.InternalServices.SearchServiceController.Preview(String keywords, String culture, Int32 forceWild, Int32 portal) at lambda_method(Closure , Object , Object[] ) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.&lt;&gt;c__DisplayClass13.&lt;GetExecutor&gt;b__c(Object instance, Object[] methodParameters) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.&lt;&gt;c__DisplayClass5.&lt;ExecuteAsync&gt;b__4() at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)</pre> <p>&nbsp;</p> <p>&nbsp;</p>
>>>>>>> da72f53 (Updates with blog content and descriptions updated)

