---
title: "Including additional DLL&rsquo;s in an MSBuild script for Module Packaging"
author: Chris Hammond
publishDate: 2011-01-05T14:04:05
updateDate: 2024-05-18T02:44:34
tags: [ 'Build', 'DLL', 'DNN', 'DotNetNuke', 'MSBuild' ]
excerpt: "Late last year I created a blog post and video about a new version of the module development template that I released on CodeplexGitHub. This new template uses MSBuild scripts instead of NANT scripts to automate the packaging process for the modules built with the template.  The MSBuild script works well out of the box, to package your module you simple change into RELEASE mode and then execute the build. "
url: /2011/including-additional-dllrsquos-in-an-msbuild-script-for-module-packaging  # Use the generated URL with year
---
<p>Late last year I created a <a href="https://www.dnnsoftware.com/community-blog/cid/132127/new-dotnetnuke-module-development-templates-w-video">blog post and video about a new version of the module development template</a> that I released on <a href="https://github.com/chrishammond/dnntemplates"><s>Codeplex</s>GitHub</a>. This new template uses MSBuild scripts instead of NANT scripts to automate the packaging process for the modules built with the template.</p>  <p>The MSBuild script works well out of the box, to package your module you simple change into RELEASE mode and then execute the build.</p>  <p>If your project contains references to DLLs (in the website's BIN folder) that you also need to package up so that you can deploy them with the module however things become a little murky. Earlier today Bruce posted on that original blog post asking how to include those DLLs in the build script so they get packaged automagically.</p>  <p>I thought this would be easy, simply add a new line to the MS Build file for the DLL (two actually so that you can target both the INSTALL and SOURCE packages that get built). The existing DLL gets pulled in with the following line (this line is found twice in the modulepackage.targets file)</p>  <div class="csharpcode"> <pre class="alt"> <span class="lnum">   1:  </span>    &lt;Copy SourceFiles=<span class="str">"$(MSBuildDnnBinPath)\$(AssemblyName).dll"</span> DestinationFolder=<span class="str">"$(MSBuildProjectDirectory)\Package\bin"</span>/&gt;</pre> </div> <style type="text/css">.csharpcode, .csharpcode pre     {     font-size: small;     color: black;     font-family: consolas, "Courier New", courier, monospace;     background-color: #ffffff;     /*white-space: pre;*/     }     .csharpcode pre { margin: 0em; }     .csharpcode .rem { color: #008000; }     .csharpcode .kwrd { color: #0000ff; }     .csharpcode .str { color: #006080; }     .csharpcode .op { color: #0000c0; }     .csharpcode .preproc { color: #cc6633; }     .csharpcode .asp { background-color: #ffff00; }     .csharpcode .html { color: #800000; }     .csharpcode .attr { color: #ff0000; }     .csharpcode .alt     {     background-color: #f4f4f4;     width: 100%;     margin: 0em;     }     .csharpcode .lnum { color: #606060; } </style> <p>So you would think adding another one would simply be</p>  <div class="csharpcode"> <pre class="alt"> <span class="lnum">   1:  </span> &lt;Copy SourceFiles=<span class="str">"$(MSBuildDnnBinPath)\$(AssemblyName).dll"</span> DestinationFolder=<span class="str">"$(MSBuildProjectDirectory)\Package\bin"</span>/&gt;</pre>  <pre> <span class="lnum">   2:  </span> &lt;Copy SourceFiles=<span class="str">"$(MSBuildDnnBinPath)\SOMEDLLNAME.dll"</span> DestinationFolder=<span class="str">"$(MSBuildProjectDirectory)\Package\bin"</span>/&gt;</pre> </div> <style type="text/css">.csharpcode, .csharpcode pre     {     font-size: small;     color: black;     font-family: consolas, "Courier New", courier, monospace;     background-color: #ffffff;     /*white-space: pre;*/     }     .csharpcode pre { margin: 0em; }     .csharpcode .rem { color: #008000; }     .csharpcode .kwrd { color: #0000ff; }     .csharpcode .str { color: #006080; }     .csharpcode .op { color: #0000c0; }     .csharpcode .preproc { color: #cc6633; }     .csharpcode .asp { background-color: #ffff00; }     .csharpcode .html { color: #800000; }     .csharpcode .attr { color: #ff0000; }     .csharpcode .alt     {     background-color: #f4f4f4;     width: 100%;     margin: 0em;     }     .csharpcode .lnum { color: #606060; } </style> <p>but if you do a build and check the packages you'll find that the DLL doesn't get included.</p>  <p>So what gives? It should be that easy. I racked my head on this for a while and figured something out, something I didn't realize. Visual Studio actually caches the MSBuild file. So if you make changes, and then try to run a build in RELEASE mode you won't see those changes take effect. What do you have to do? Unfortunately you have to close the project and load it again.</p>  <p>This is definitely a pain, but in the long run as easy as the scripts make packaging of modules I would think that the off times you have to make a change, restarting the project isn't that big a deal, as long as you remember that fact.</p>  <p>One other thing to remember when you are packaging up a module, you need to tell DNN about the DLL that gets included in the package, you do this by adding a couple of lines to the .DNN manifest file.</p>  <p>For example this</p>  <div class="csharpcode"> <pre class="alt"> <span class="lnum">   1:  </span>&lt;component type=<span class="str">"Assembly"</span>&gt;</pre>  <pre> <span class="lnum">   2:  </span>  &lt;assemblies&gt;</pre>  <pre class="alt"> <span class="lnum">   3:  </span>    &lt;basePath&gt;bin&lt;/basePath&gt;</pre>  <pre> <span class="lnum">   4:  </span>    &lt;assembly&gt;</pre>  <pre class="alt"> <span class="lnum">   5:  </span>      &lt;name&gt;dnnsimplearticle.dll&lt;/name&gt;</pre>  <pre> <span class="lnum">   6:  </span>    &lt;/assembly&gt;</pre>  <pre class="alt"> <span class="lnum">   7:  </span>  &lt;/assemblies&gt;</pre>  <pre> <span class="lnum">   8:  </span>&lt;/component&gt;</pre> </div> <style type="text/css">.csharpcode, .csharpcode pre     {     font-size: small;     color: black;     font-family: consolas, "Courier New", courier, monospace;     background-color: #ffffff;     /*white-space: pre;*/     }     .csharpcode pre { margin: 0em; }     .csharpcode .rem { color: #008000; }     .csharpcode .kwrd { color: #0000ff; }     .csharpcode .str { color: #006080; }     .csharpcode .op { color: #0000c0; }     .csharpcode .preproc { color: #cc6633; }     .csharpcode .asp { background-color: #ffff00; }     .csharpcode .html { color: #800000; }     .csharpcode .attr { color: #ff0000; }     .csharpcode .alt     {     background-color: #f4f4f4;     width: 100%;     margin: 0em;     }     .csharpcode .lnum { color: #606060; } </style> <p>Becomes</p>  <div class="csharpcode"> <pre class="alt"> <span class="lnum">   1:  </span>&lt;component type=<span class="str">"Assembly"</span>&gt;</pre>  <pre> <span class="lnum">   2:  </span>  &lt;assemblies&gt;</pre>  <pre class="alt"> <span class="lnum">   3:  </span>    &lt;basePath&gt;bin&lt;/basePath&gt;</pre>  <pre> <span class="lnum">   4:  </span>    &lt;assembly&gt;</pre>  <pre class="alt"> <span class="lnum">   5:  </span>      &lt;name&gt;dnnsimplearticle.dll&lt;/name&gt;</pre>  <pre> <span class="lnum">   6:  </span>    &lt;/assembly&gt;</pre>  <pre class="alt"> <span class="lnum">   7:  </span>    &lt;assembly&gt;</pre>  <pre> <span class="lnum">   8:  </span>      &lt;name&gt;SOMEDLLNAME.dll&lt;/name&gt;</pre>  <pre class="alt"> <span class="lnum">   9:  </span>    &lt;/assembly&gt;</pre>  <pre> <span class="lnum">  10:  </span>  &lt;/assemblies&gt;</pre>  <pre class="alt"> <span class="lnum">  11:  </span>&lt;/component&gt;</pre> </div> <style type="text/css">.csharpcode, .csharpcode pre     {     font-size: small;     color: black;     font-family: consolas, "Courier New", courier, monospace;     background-color: #ffffff;     /*white-space: pre;*/     }     .csharpcode pre { margin: 0em; }     .csharpcode .rem { color: #008000; }     .csharpcode .kwrd { color: #0000ff; }     .csharpcode .str { color: #006080; }     .csharpcode .op { color: #0000c0; }     .csharpcode .preproc { color: #cc6633; }     .csharpcode .asp { background-color: #ffff00; }     .csharpcode .html { color: #800000; }     .csharpcode .attr { color: #ff0000; }     .csharpcode .alt     {     background-color: #f4f4f4;     width: 100%;     margin: 0em;     }     .csharpcode .lnum { color: #606060; } </style> <p>The sample code in this blog post references <a href="https://github.com/ChrisHammond/dnnsimplearticle">DNNSimpleArticle</a> which you can download in C# or VB.NET from <a href="https://github.com/ChrisHammond/dnnsimplearticle">https://github.com/ChrisHammond/dnnsimplearticle</a></p>  <p>Good luck, and get coding!</p> 
